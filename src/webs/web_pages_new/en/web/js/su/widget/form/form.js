(function(a){a.su.Widget("form",{defaults:{fields:[],proxy:null,submitBtn:null,autoLoad:true},create:function(d,b){var c=this;c.each(function(h,l){var f=a(l);if(!f.is("form")){var k=a("<form></form>");k.append(f.children().detach());f.append(k)}a.extend(l,d,b);var g=l.proxy;if(g){if(!g.isProxy){g=new a.su.Proxy(g)}l.proxy=g}l.isForm=true;if(l.isPanel){l.isFormPanel=true}if(l.autoLoad){f.form("load")}if(l.submitBtn){var j=a.type(l.submitBtn),e=null;if(j==="string"){if(l.submitBtn==="default"){e=a('<button type="button"></button>').button({text:a.su.CHAR.OPERATION.SAVE,cls:"submit"}).button("getContainer");if(f.is("form")){f.append(e)}else{f.find("form").append(e)}}else{e=a(l.submitBtn);if(e.length==0){console.error("Can not find the submit button!")}}}else{if(a(l.submitBtn).attr("isButton")==true){e=a(l.submitBtn)}else{console.error("Can not find the submit button!")}}l.submitBtn=e.get(0)}l.id=l.id||a.su.randomId("form");var g=a(l.proxy);g.on("ev_read",function(n,i,m,o){c.form("loadData",i)})});if(b.submitBtn){c.delegate("div.button-container.submit button","click",function(f){if(c.form.validate()){c.form("submit")}})}return c},validate:function(){return true},submit:function(c,f){var c=c||this,b=c.form("getProxy"),d=c.form("serialize"),e=f[1]||{},g=f[2]||null;if(b){b.write(a.extend({},d,e),g)}},load:function(c){var c=c||this;var b=c.get(0).proxy;if(b){b.read()}},loadData:function(j,e){var j=j||this,g=e[1]||[],h=j.get(0).fields;for(var i=0;i<h.length;i++){var k=h[i],c=k.name,b=k.mapping||c;if(c){var f=j.find("[name="+c+"]");if(f.length!=0){var d=f.get(0).xtype;var l=g[b];if(l!==undefined){f[d]("setValue",l)}else{console.error("Data not found with the name of "+c+"! Please Check the data object or the url!");return null}}}}j.data("data",g);j.trigger("ev_loadData",g)},getProxy:function(c){var c=c||this,b=c.get(0).proxy;if(b&&b.isProxy){return b}else{return null}},serialize:function(g){var g=g||this,f=g.is("form")?g:g.find("form");var c=f.serializeArray(),i={};for(var e=0;e<c.length;e++){var b=c[e],d=b.name,h=b.value;i[d]=h}return i},reset:function(b){var b=b||this;console.log("form reset");return b}})})(jQuery);