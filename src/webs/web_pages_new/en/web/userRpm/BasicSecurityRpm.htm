<link rel="stylesheet" href="../dynaform/widget.css"></link>
<script type="text/javascript" src="../js/su/su.js"></script>
<script type="text/javascript" src="../js/su/widget/widget.js"></script>
<script type="text/javascript" src="../js/su/widget/form/radio.js"></script>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<SCRIPT type="text/javascript">
<!--//
		function isStatOn(item)
		{
			return 	(secParam[0] & item);
		}
			
		var FW_SPI					=	0x00000001;
		var VPN_PPTP_PASSTHROUGH	=	0x00000100;
		var VPN_L2TP_PASSTHROUGH	=	0x00000200;
		var VPN_IPSEC_PASSTHROUGH	=	0x00000400;
		var NAT_FTP_ALG				=	0x00010000;
		var NAT_TFTP_ALG			=	0x00020000;
		var NAT_H323_ALG			=	0x00040000;
		var NAT_RTSP_ALG			=	0x00080000;
		var NAT_SIP_ALG				=	0x00100000;
		var spifw = isStatOn(FW_SPI); 
		var pptp = isStatOn(VPN_PPTP_PASSTHROUGH);
		var l2tp = isStatOn(VPN_L2TP_PASSTHROUGH);
		var ipsec = isStatOn(VPN_IPSEC_PASSTHROUGH);
		var ftp = isStatOn(NAT_FTP_ALG);
		var tftp = isStatOn(NAT_TFTP_ALG);
		var h323 = isStatOn(NAT_H323_ALG);
		var rtsp = isStatOn(NAT_RTSP_ALG);
		var sip = isStatOn(NAT_SIP_ALG);
		
		function doSave()
		{			
			var lp = location.pathname;
			
			var s = $("input#spi").radio("getValue");
			var p = $("input#pptp").radio("getValue");
			var l = $("input#l2tp").radio("getValue");
			var i = $("input#ipsec").radio("getValue");
			var f = $("input#ftp").radio("getValue");
			var t = $("input#tftp").radio("getValue");
			var h = $("input#h323").radio("getValue");
			var r = $("input#rtsp").radio("getValue");
			var u = $("input#sip").radio("getValue");
			
			var new_stat = s | (p << 8) | (l << 9) | (i << 10) | (f << 16) | (t << 17) | (h << 18) | (r << 19) | (u << 20);
		
			location.href = lp + "?stat=" + new_stat + "&Save=Save";				
			return true;
		}
		
		function doHelp()
		{
			location.href="../help/BasicSecurityHelpRpm.htm";
		}
	//-->
</SCRIPT>
</HEAD>
<BODY onload = "setTagStr(document,'ntw_bsc_sec');LoadHelp('BasicSecurityHelpRpm.htm')">
<FORM action="BasicSecurityRpm.htm" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
  <TABLE border="0" cellspacing="0" cellpadding="0">
    <TR>
      <TD align="left" valign="middle" class="h1" colspan=2 id="t_title">Basic Security</TD>
    </TR>
    <TR>
      <TD class = "blue" colspan=2></TD>
    </TR>
    <TR>
      <TD class=h2 colspan=3 id="t_fw">Firewall</TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_spi_fw">SPI Firewall:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="spi" id="spi">
    </TR>
    <TR>
      <TD class="blue"  colspan=2></TD>
    </TR>
    <TR>
      <TD class=h2 colspan=3 id="t_vpn">VPN</TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_pptp_passthrough">PPTP Passthrough:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="pptp"></TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_l2tp_passthrough">L2TP Passthrough:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="l2tp"></TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_ipsec_passthrough">IPSec Passthrough:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="ipsec"></TD>
    </TR>
    <TR>
      <TD class="blue"  colspan=2></TD>
    </TR>
    <TR>
      <TD class=h2 colspan=3 id="t_nat">ALG</TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_ftp_alg">FTP ALG:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="ftp"></TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_tftp_alg">TFTP ALG:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="tftp"></TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_h323_alg">H323 ALG:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="h323"></TD>
    </TR>
    <TR>
      <TD class=Item align=left><B><SPAN id="t_rtsp_alg">RTSP ALG:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="rtsp"></TD>
    </TR>
	<TR>
      <TD class=Item align=left><B><SPAN id="t_sip_alg">SIP ALG:</SPAN></B></TD>
      <TD width = "100%"><INPUT name="pptp" id="sip"></TD>
    </TR>
    <TR>
      <TD class="blue"  colspan=2></TD>
    </TR>
    <TR>
      <TD></TD>
      <TD colspan=2><INPUT name="Save" type="button" class="buttonBig" value="Save" onClick="return doSave();"></TD>
    </TR>
  </TABLE>
</FORM>
</BODY>
<HEAD>
<META http-equiv="pragma" content="no-cache">
</HEAD>
</HTML>

<SCRIPT type="text/javascript">
	$("input#spi").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#pptp").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#l2tp").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#ipsec").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#ftp").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#tftp").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#h323").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#rtsp").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
	$("input#sip").radio({
		columns: 2,
		items: [
			{boxlabel: (js_enable = "Enable"), inputvalue: "1"},
			{boxlabel: (js_disable = "Disable"), inputvalue: "0"}
		]
	});
</SCRIPT>

<SCRIPT type="text/javascript">
	if(spifw)
	{
		$("input#spi").radio("setValue", 1)
	}
	else
	{
		$("input#spi").radio("setValue", 0)
	}
	
	if(pptp)
	{
		$("input#pptp").radio("setValue", 1)
	}
	else
	{
		$("input#pptp").radio("setValue", 0)
	}
	
	if(l2tp)
	{
		$("input#l2tp").radio("setValue", 1)
	}
	else
	{
		$("input#l2tp").radio("setValue", 0)
	}
	
	if(ipsec)
	{
		$("input#ipsec").radio("setValue", 1)
	}
	else
	{
		$("input#ipsec").radio("setValue", 0)
	}
	
	if(ftp)
	{
		$("input#ftp").radio("setValue", 1)
	}
	else
	{
		$("input#ftp").radio("setValue", 0)
	}
	
	if(tftp)
	{
		$("input#tftp").radio("setValue", 1)
	}
	else
	{
		$("input#tftp").radio("setValue", 0)
	}
	
	if(h323)
	{
		$("input#h323").radio("setValue", 1)
	}
	else
	{
		$("input#h323").radio("setValue", 0)
	}
	
	if(rtsp)
	{
		$("input#rtsp").radio("setValue", 1)
	}
	else
	{
		$("input#rtsp").radio("setValue", 0)
	}
	
	if(sip)
	{
		$("input#sip").radio("setValue", 1)
	}
	else
	{
		$("input#sip").radio("setValue", 0)
	}
</SCRIPT>
