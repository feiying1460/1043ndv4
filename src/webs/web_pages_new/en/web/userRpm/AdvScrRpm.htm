<link rel="stylesheet" href="../dynaform/widget.css"></link>
<script type="text/javascript" src="../js/su/su.js"></script>
<script type="text/javascript" src="../js/su/widget/widget.js"></script>
<script type="text/javascript" src="../js/su/widget/form/textbox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/combobox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/checkbox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/radio.js"></script>
<SCRIPT type="text/javascript">
<!--
var CTFEnb = false;
function showDosOpt()
{
	if(!advPara[0])
	{
		return true;
	}	
	var show = document.forms[0].dosAttack[1].checked ? false : true, 
		disableStr = show ? "enable" : "disable";
	$("input#bIcmpFlood").checkbox(disableStr);
	document.forms[0].usIcmpFlood.disabled  = !show;
	$("input#bUdpFlood").checkbox(CTFEnb ? "disable" : disableStr);
	document.forms[0].usUdpFlood.disabled = !show || CTFEnb;
	$("input#bTcpSynFlood").checkbox(CTFEnb ? "disable" : disableStr);
	document.forms[0].usTcpSynFlood.disabled = !show || CTFEnb;
	$("input#ping").checkbox(disableStr);
	$("input#lanPing").checkbox(disableStr);
	return true;
}
function doShow()
{
location.href="../userRpm/MiscShowRpm.htm";
}
function doSubmit()
{
if (advPara[0])
{
var element;
element=document.forms[0].usIcmpFlood;
if((!is_number(element.value,5,3600))||(element.value==""))
		 {
                       alert(js_bad_icmp_thrd="Invalid ICMP-FLOOD Packets threshold, please input another number(5-3600)!"); 
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
element=document.forms[0].usUdpFlood;
if((!is_number(element.value,5,3600))||(element.value=="")) 
		{
                        alert(js_bad_udp_thrd="Invalid UDP-FLOOD Packets threshold, please input another number(5-3600)!");
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
element=document.forms[0].usTcpSynFlood;
if((!is_number(element.value,5,3600))||(element.value=="")) 
		{
alert(js_bad_tcp_thrd="Invalid TCP-FLOOD Packets threshold, please input another number(5-3600)!"); 
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	return true;
}
function pageload()
{
	showDosOpt();
}
//-->
</SCRIPT>
</HEAD>
<BODY>
<CENTER>
  <FORM action="AdvScrRpm.htm" enctype="multipart/form-data" method="get" >
    <TABLE id="autoWidth">
      <TR>
			<TD class="h1" colspan="2"><DIV id="t_title">Advanced Security</DIV></TD>
		</TR>
		<TR id="CTFEffectTr" style="display: none;">
			<TD class="autoLine" colspan="2">
				<span class="error" id="t_chng">Before enabling the UDP-FLOOD Filtering and TCP-SYN-FLOOD Attack Filtering feature, please go to the <a href="../userRpm/FastpathCfgRpm.htm" class="simpleLink">NAT Boost</a> page and disable the NAT Boost function.</span>
			</TD>
      </TR>
      <TR>
			<TD class="blue" colspan="2"></TD>
      </TR>
      <SCRIPT type="text/javascript">
if (advPara[0] && advPara[1])
	document.getElementById("t_title").innerHTML = "<span id=\"t_adv_scr\">Advanced Security</span>";
else if (advPara[1])
	document.getElementById("t_title").innerHTML = "<span id=\"t_ping\">Ping</span>";
else
	document.getElementById("t_title").innerHTML = "<span id=\"t_ping_wan\">Ping from WAN</span>";
if (advPara[0])
{
			document.write('<TR><TD class="Item" id="t_interval">Packets Statistics Interval (5 ~ 60):</TD><TD><select id="interval" name="interval" class="listS">');
document.write('<option value=5> 5 </option>');
document.write('<option value=10> 10 </option>');
document.write('<option value=15> 15 </option>');
document.write('<option value=20> 20 </option>');
document.write('<option value=25> 25 </option>');
document.write('<option value=30> 30 </option>');
document.write('<option value=35> 35 </option>');
document.write('<option value=40> 40 </option>');
document.write('<option value=45> 45 </option>');
document.write('<option value=50> 50 </option>');
document.write('<option value=55> 55 </option>');
document.write('<option value=60> 60 </option>');
document.write('</select><span id="t_seconds">&nbsp;Seconds</span></TD></TR>');
			document.write('<TR><TD colspan="2"></TD></TR>');
			document.write('<TR><TD class="Item" id="t_dos_prot">DoS Protection:</TD><TD><input id="dosAttack" name="dosAttack" /></TD></TR>');
			document.write('<TR><TD colspan="2"></TD></TR>');
			document.write('<TR><TD colspan="2"><input id="bIcmpFlood" name="bIcmpFlood"/></TD></TR>');
			document.write('<TR><TD class="Item" id="t_icmp_thrd">ICMP-FLOOD Packets Threshold (5 ~ 3600):</TD><TD><input name="usIcmpFlood" type="text" class="text" value="50" size="6" maxlength="5" >&nbsp;<span id="t_pkts" name="t_pkts">Packets/Secs </span></TD></TR> ');
			document.write('<TR><TD colspan="2"></TD></TR>');
			document.write('<TR><TD colspan="2"><input name="bUdpFlood" id="bUdpFlood" /></TD></TR>');
			document.write('<TR><TD class="Item" id="t_udp_thrd">UDP-FLOOD Packets Threshold (5 ~ 3600):</TD><TD><input name="usUdpFlood" type="text" class="text" value="500" size="6" maxlength="5" ><span id="t_pkts" name="t_pkts">&nbsp;Packets/Secs</span></TD></TR>');
			document.write('<TR><TD colspan="2"></TD></TR>');
			document.write('<TR><TD colspan="2"><input id="bTcpSynFlood" name="bTcpSynFlood" /></TD></TR>');
			document.write('<TR><TD class="Item" id="t_tcp_thrd">TCP-SYN-FLOOD Packets Threshold (5 ~ 3600):</TD><TD><input name="usTcpSynFlood" type="text" class="text" value="50" size="6" maxlength="5" ><span id="t_pkts" name="t_pkts">&nbsp;Packets/Secs</span></TD></TR>');
			document.write('<TR><TD colspan="2"></TD></TR>');
}
</SCRIPT>
      <TR>
			<TD colspan="2"><input id="ping" name="ping" /></TD>
      </TR>
      <SCRIPT type="text/javascript">
if (advPara[1]) 
{
			document.write('<TR><TD colspan="2"><input id="lanPing" name="lanPing" /></TD></TR>');
}
</SCRIPT>
      <TR>
			<TD class="blue" colspan="2"></TD>
      </TR>
      <TR>
			<TD colspan="2">
				<INPUT name="Save" type="submit" class="buttonBig" value="Save" onClick="return doSubmit();">
          &nbsp;
          <SCRIPT type="text/javascript">
if (advPara[0]) 
					document.write('<input name=Showhostlist type=button class=buttonL onClick=\"doShow();\" value=\"Blocked DoS Host List\">');
				</SCRIPT>
			</TD>
      </TR>
    </TABLE>
  </FORM>
</CENTER>
</BODY>
<HEAD>
<META http-equiv="pragma" content="no-cache">
</HEAD>
</HTML>
<script type="text/javascript">
if (advPara[0])
{
	$("input#dosAttack").radio({
		columns: 2,
		items: [
			{boxlabel: (js_disable = "Disable"), inputvalue: "1"},
			{boxlabel: (js_enable = "Enable"), inputvalue: "2"}
		]
	}).on("ev_click", showDosOpt);
	$("input#bIcmpFlood").checkbox({
		items: [{boxlabel: (js_en_icmp = "Enable ICMP-FLOOD Attack Filtering"), inputvalue: "2"}]
	});
	$("input#bUdpFlood").checkbox({
		items: [{boxlabel: (js_en_udp = "Enable UDP-FLOOD Filtering"), inputvalue: "2"}]
	});
	$("input#bTcpSynFlood").checkbox({
		items: [{boxlabel: (js_en_tcp = "Enable TCP-SYN-FLOOD Attack Filtering"), inputvalue: "2"}]
	});
	document.forms[0].interval.value =advPara[2];
	$("select#interval").combobox({cls: "inline", inputCls: "s"});
	if (advPara[3] == 0)
	{
		$("input#dosAttack").radio("setValue", 1);
	}
	else
	{
		$("input#dosAttack").radio("setValue", 2);
	}
	$("input#bIcmpFlood").checkbox("setChecked", advPara[4]);
	document.forms[0].usIcmpFlood.value =advPara[5];
	$("input#bUdpFlood").checkbox("setChecked", advPara[6]);
	document.forms[0].usUdpFlood.value =advPara[7];
	$("input#bTcpSynFlood").checkbox("setChecked", advPara[8]);
	document.forms[0].usTcpSynFlood.value =advPara[9];
}
$("input#ping").checkbox({
	items: [{boxlabel: (js_ingore_ping = "Ignore Ping Packet from WAN Port to Router"), inputvalue: "2"}]
});
$("input#ping").checkbox("setChecked", advPara[10]);
if (advPara[1])
{
	$("input#lanPing").checkbox({
		items: [{boxlabel: (js_forbid_ping = "Forbid Ping Packet from LAN Port to Router"), inputvalue: "2"}]
	});
	$("input#lanPing").checkbox("setChecked", advPara[11]);
}

getCTFFlag("AdvScrRpm.htm", function (flag){
	CTFEnb = flag;
	if (CTFEnb)
	{
		$("#CTFEffectTr").show();

		$("input#bUdpFlood").checkbox("disable");
		document.forms[0].usUdpFlood.disabled = true;
		$("input#bTcpSynFlood").checkbox("disable");
		document.forms[0].usTcpSynFlood.disabled = true;
	}
	else
	{
		$("#CTFEffectTr").hide();
	}
}, 1);
</script>