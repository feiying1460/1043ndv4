
<link rel="stylesheet" href="../dynaform/widget.css"></link>
<!--[if lte IE 8]>
<link href="../dynaform/ie8.css", rel="stylesheet" type="text/css">
 <![endif]-->
<script type="text/javascript" src="../js/su/su.js"></script>
<script type="text/javascript" src="../js/su/widget/widget.js"></script>
<script type="text/javascript" src="../js/su/widget/form/textbox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/combobox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/checkbox.js"></script>
<script type="text/javascript" src="../js/su/widget/form/radio.js"></script>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<!--JS-->
<SCRIPT type="text/javascript">
<!--
function doBack(nPage)
{
	location.href="AccessCtrlAccessRulesRpm.htm?Page="+nPage;
}
function getValLen(val)
{
	var len = 0;
	var i = 0;
	for (i = 0; i < val.length; i ++)
	{
		var c = val.charAt(i);
		len += ((c >= ' ') && (c <= '~')) ? 1 : 2;
	}
	return len;
}

function style_display_on()
{
	if (window.ActiveXObject)
	{ // IE
		return "block";
	}
	else if (window.XMLHttpRequest)
	{ // Mozilla, Safari,...
		return "table-row";
	}
}
function selAddrType()
{
	str = style_display_on();
	if ( document.forms[0].address_type.value == 1 )
	{
		document.getElementById("ip_area").style.display = str;
		document.getElementById("mac_area").style.display = "none";
	}
	else if ( document.forms[0].address_type.value == 0 )
	{
		document.getElementById("ip_area").style.display = "none";
		document.getElementById("mac_area").style.display = str;
	}
	
}
function doSwitchProto()
{
	str=style_display_on();
	if (document.forms[0].target_type.value == 1 )
	{
	document.getElementById("port").style.display=(document.forms[0].proto.value==3)?"none":str;
	//document.getElementById("spaceline").style.display=(document.forms[0].proto.value==3)?"none":str;
	document.getElementById("commonportlist").style.display=(document.forms[0].proto.value==3)?"none":str;
	}
}
 function selTargetType()
 {
	str=style_display_on();
	document.getElementById("ip_dst").style.display=(document.forms[0].target_type.value == 1 )?str:"none";
	document.getElementById("port").style.display=(document.forms[0].target_type.value == 1 )?str:"none";
	document.getElementById("proto_area").style.display=(document.forms[0].target_type.value == 1 )?str:"none";
	//document.getElementById("spaceline").style.display=(document.forms[0].target_type.value == 1)?str:"none";
	document.getElementById("commonportlist").style.display=(document.forms[0].target_type.value == 1 )?str:"none";
	doSwitchProto();
	document.getElementById("url0").style.display=(document.forms[0].target_type.value == 1)?"none":str;
	document.getElementById("url1").style.display=(document.forms[0].target_type.value == 1)?"none":str;
	document.getElementById("url2").style.display=(document.forms[0].target_type.value == 1)?"none":str;
	document.getElementById("url3").style.display=(document.forms[0].target_type.value == 1)?"none":str;
 }

 function change_weekdays_status()
{
	var Status = document.forms[0].day_type_all.checked == true ? 1 : 0;
	if (Status == 1)
	{
		$("input#Mon_select").checkbox("setChecked", true);
		$("input#Tue_select").checkbox("setChecked", true);
		$("input#Wed_select").checkbox("setChecked", true);
		$("input#Thu_select").checkbox("setChecked", true);
		$("input#Fri_select").checkbox("setChecked", true);
		$("input#Sat_select").checkbox("setChecked", true);
		$("input#Sun_select").checkbox("setChecked", true);
		
		$("input#Mon_select").checkbox("disable");
		$("input#Tue_select").checkbox("disable");
		$("input#Wed_select").checkbox("disable");
		$("input#Thu_select").checkbox("disable");
		$("input#Fri_select").checkbox("disable");
		$("input#Sat_select").checkbox("disable");
		$("input#Sun_select").checkbox("disable");
	}
	else if (Status == 0)
	{
		$("input#Mon_select").checkbox("setChecked", timeSchedAdvDynArray[2]);
		$("input#Tue_select").checkbox("setChecked", timeSchedAdvDynArray[3]);
		$("input#Wed_select").checkbox("setChecked", timeSchedAdvDynArray[4]);
		$("input#Thu_select").checkbox("setChecked", timeSchedAdvDynArray[5]);
		$("input#Fri_select").checkbox("setChecked", timeSchedAdvDynArray[6]);
		$("input#Sat_select").checkbox("setChecked", timeSchedAdvDynArray[7]);
		$("input#Sun_select").checkbox("setChecked", timeSchedAdvDynArray[8]);
		
		$("input#Mon_select").checkbox("enable");
		$("input#Tue_select").checkbox("enable");
		$("input#Wed_select").checkbox("enable");
		$("input#Thu_select").checkbox("enable");
		$("input#Fri_select").checkbox("enable");
		$("input#Sat_select").checkbox("enable");
		$("input#Sun_select").checkbox("enable");
	}
}
function change_hours_status()
{
	if ($("input#all_hours").checkbox("getChecked") == true)
	{
		document.forms[0].time_sched_start_time.disabled = 1;
		document.forms[0].time_sched_end_time.disabled = 1;
	}
	else
	{
		document.forms[0].time_sched_start_time.disabled = 0;
		document.forms[0].time_sched_end_time.disabled = 0;
	}
}
function check_all_status()
{
	document.forms[0].time_sched_name.value = timeSchedAdvDynArray[0];
	if(1 == timeSchedAdvDynArray[1])
	{
		$("input#day_type").radio("setValue", 1);
	}
	if (0 == timeSchedAdvDynArray[1])
	{
		$("input#day_type").radio("setValue", 0);
	}
	change_weekdays_status();
}
 var commonportlist = new Array(
0, "", " id=\"t_pl_sel\">--Please Select--<", 0,
1, 53, " id=\"t_dns\">DNS<", 2,
2, 21, " id=\"t_ftp\">FTP<", 1,
3, 70, " id=\"t_gopher\">GOPHER<", 1,
4, 80, " id=\"t_http\">HTTP<", 1,
5, 119, " id=\"t_nntp\">NNTP<", 1,
6, 110, " id=\"t_pop3\">POP3<", 1,
7, 1723, " id=\"t_pptp\">PPTP<", 0,
8, 25, " id=\"t_sntp\">SMTP<", 1,
9, 1080, " id=\"t_sock\">SOCK<", 0,
10, 23, " id=\"t_telnet\">TELNET<", 1
);
function doCommonPortChange()
{
	var n = document.forms[0].Commonport.selectedIndex;
	if(n > 0)
	{
		document.forms[0].dst_port_start.value = commonportlist[(n*4)+1];
		$("select#proto").combobox("selWithoutTrigger", commonportlist[(n*4)+3]);
	}
}
function IsAnyTargetChanged()
{
	if (document.forms[0].Target_Index.value != 255)
	{
		return false;
	}
	if (document.forms[0].target_type.value != access_targetss_adv_dyn_array[0])
	{
		return true;
	}
	if (document.forms[0].targets_lists_name.value != access_targetss_adv_dyn_array[1])
	{
		return true;
	}
	if (access_targetss_adv_dyn_array[0] != 1)
	{
		return true;
	}
	
	if (document.forms[0].dst_ip_start.value != access_targetss_adv_dyn_array[2])
	{
		return true;
	}
	if (document.forms[0].dst_ip_end.value != document.forms[0].dst_ip_start.value)
	{
		return true;
	}
	if (document.forms[0].proto.value != access_targetss_adv_dyn_array[4])
	{
		return true;
	}
	if (document.forms[0].dst_port_start.value != access_targetss_adv_dyn_array[5])
	{
		return true;
	}
		
	if (document.forms[0].dst_port_end.value != document.forms[0].dst_port_start.value)
	{
		return true;
	}
	return false;
}

function IsAnytimeChange()
{
	if (document.forms[0].Schedule_Index.value != 255)
	{
		return false;
	}
	
	if (document.forms[0].time_sched_name.value !=timeSchedAdvDynArray[0])
	{
		return true;
	}
	
	if(document.forms[0].day_type_all.checked != true)
	{
		return true;
	}
	if ($("input#all_hours").checkbox("getChecked") != timeSchedAdvDynArray[9])
	{
		return true;
	}
	return false;
}
function doSubmit()
{
	var isTargetChanged = false;
	var isScheduleChanged = false;
	<!--Rule name***-->
	var desc_len = getValLen(document.forms[0].rule_name.value);
	if ((desc_len < 1) || (desc_len > 24))
	{
		alert(js_pl_input_name="Please input name of the control rule (Length < 25)!");
		var element = document.forms[0].rule_name;
		if(element)
		{
			element.focus();
			element.select();
		}
		return false;
	}
	
	<!--Host***-->
	
	desc_len = getValLen(document.forms[0].hosts_lists_name.value);
	if ((desc_len < 1) || (desc_len > 24))
	{
		alert(js_pl_host_name="Please input a valid host description (Length < 25)!");
		var element = document.forms[0].hosts_lists_name;
		if(element)
		{
			element.focus();
			element.select();
		}
		return false;
	}
	if (document.forms[0].address_type.value == 1 )
	{
		if (!(document.forms[0].src_ip_start.value.length) && (!document.forms[0].src_ip_end.value.length))
		{
			alert(js_pl_ip_addr="Please input the IP address !");
			var element = document.forms[0].src_ip_start;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
			
		}
		else
		{
			if (document.forms[0].src_ip_start.value.length)
			{
				if (false == is_ipaddr(document.forms[0].src_ip_start.value))
				{
					var element = document.forms[0].src_ip_start;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
					
				}
			}
			if (document.forms[0].src_ip_end.value.length)
			{
				if (false == is_ipaddr(document.forms[0].src_ip_end.value))
				{
					var element = document.forms[0].src_ip_end;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
		}
	}
	else if (document.forms[0].address_type.value == 0 )
	{
		if (false == is_macaddr(document.forms[0].mac_addr.value))
		{
			var element = document.forms[0].mac_addr;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	
	<!--Target***-->
	isTargetChanged = IsAnyTargetChanged();
	desc_len = getValLen(document.forms[0].targets_lists_name.value);
	if ((desc_len < 1) || (desc_len > 24))
	{
		if (document.forms[0].Target_Index.value != 255 || isTargetChanged)
		{
			alert(js_pl_input_desc="Please input the description of target list (Length < 25)!");
			var element = document.forms[0].targets_lists_name;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	
	if (document.forms[0].target_type.value == 1)
	{
		if (document.forms[0].proto.value==3)
		{
			if ((!document.forms[0].dst_ip_start.value.length) && 
			(!document.forms[0].dst_ip_end.value.length))
			{
				if(document.forms[0].Target_Index.value != 255 || isTargetChanged)
				{
					alert(js_pl_ip_addr="Please input the IP address !");
					var element = document.forms[0].dst_ip_start;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
		}
		else
		{
			if ((!document.forms[0].dst_ip_start.value.length) && 
			(!document.forms[0].dst_ip_end.value.length) && 
			(!document.forms[0].dst_port_start.value.length) && 
			(!document.forms[0].dst_port_end.value.length))
			{
				if (document.forms[0].Target_Index.value != 255 || isTargetChanged)
				{
					alert(js_pl_ip_num="Please input at least a IP address or a port number !");
					var element = document.forms[0].dst_ip_start;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
			if (document.forms[0].dst_ip_start.value.length)
			{
				if (false == is_ipaddr(document.forms[0].dst_ip_start.value))
				{
					var element = document.forms[0].dst_ip_start;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
			if (document.forms[0].dst_ip_end.value.length)
			{
				if (false == is_ipaddr(document.forms[0].dst_ip_end.value))
				{
					var element = document.forms[0].dst_ip_end;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
		}
		if (document.forms[0].proto.value!=3)
		{
			if (document.forms[0].dst_port_start.value.length)
				{
					if (false == is_port(document.forms[0].dst_port_start.value))
					{
						var element = document.forms[0].dst_port_start;
						if(element)
						{
							element.focus();
							element.select();
							}
						return false;
					}
				}
			if (document.forms[0].dst_port_end.value.length)
			{
				if (false == is_port(document.forms[0].dst_port_end.value))
				{
					var element = document.forms[0].dst_port_end;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
		}
	}
	else
	{
		if (
		(document.forms[0].url_0.value=="") && 
		(document.forms[0].url_1.value=="") && 
		(document.forms[0].url_2.value=="") && 
		(document.forms[0].url_3.value=="")
		)
		{
			if (document.forms[0].Target_Index.value != 255 || isTargetChanged) 
			{
				alert(js_pl_url="Please input at least a URL of a website !");
				var element = document.forms[0].url_0;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		else
		{
			if (document.forms[0].url_0.value!="")
			{
				if (false == is_domain(document.forms[0].url_0.value))
				{
					var element = document.forms[0].url_0;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
			if (document.forms[0].url_1.value!="")
			{
				if (false == is_domain(document.forms[0].url_1.value))
				{
					var element = document.forms[0].url_1;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
			if (document.forms[0].url_2.value!="")
			{
				if (false == is_domain(document.forms[0].url_2.value))
				{
					var element = document.forms[0].url_2;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
			if (document.forms[0].url_3.value!="")
			{
				if (false == is_domain(document.forms[0].url_3.value))
				{
					var element = document.forms[0].url_3;
					if(element)
					{
						element.focus();
						element.select();
					}
					return false;
				}
			}
		}
	}
	
	
	<!--Schedule**-->
	isScheduleChanged = IsAnytimeChange();
	desc_len = getValLen(document.forms[0].time_sched_name.value);
	if ((desc_len < 1) || (desc_len > 24))
	{
		if (document.forms[0].Schedule_Index.value != 255 || isScheduleChanged)
		{
			alert(js_pl_sch_name="Please input the schedule name (Length < 25)!");
			var element = document.forms[0].time_sched_name;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	if (document.forms[0].day_type_choose.checked==true)
	{
		if (
		($("input#Mon_select").checkbox("getChecked") == false)&&
		($("input#Tue_select").checkbox("getChecked") == false)&&
		($("input#Wed_select").checkbox("getChecked") == false)&&
		($("input#Thu_select").checkbox("getChecked") == false)&&
		($("input#Fri_select").checkbox("getChecked") == false)&&
		($("input#Sat_select").checkbox("getChecked") == false)&&
		($("input#Sun_select").checkbox("getChecked") == false)
		)
		{
			if (document.forms[0].Schedule_Index.value != 255 || isScheduleChanged)
			{
				alert(js_pl_sel_day="Please select days !");
				return false;
			}
		}
	}
	if ($("input#all_hours").checkbox("getChecked") == false)
	{
		if (document.forms[0].time_sched_start_time.value=="")
		{
			if (document.forms[0].Schedule_Index.value != 255 || isScheduleChanged)
			{
				alert(js_pl_begin_time="Please input the begining time !");
				var element = document.forms[0].time_sched_start_time;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		if (document.forms[0].time_sched_end_time.value=="")
		{
			if (document.forms[0].Schedule_Index.value != 255 || isScheduleChanged)
			{
				alert(js_pl_end_time="Please input the ending time !");
				var element = document.forms[0].time_sched_end_time;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		
		var st=parseInt(document.forms[0].time_sched_start_time.value, 10);
		var et=parseInt(document.forms[0].time_sched_end_time.value, 10);
		if (st > et)
		{
			if (document.forms[0].Schedule_Index.value != 255 || isScheduleChanged)
			{
				alert(js_end_n_start_time = "The ending time should not be less than the starting time!");
				var element = document.forms[0].time_sched_end_time;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
	}
	document.forms[0].Host_Changed.value = 1;
	if (document.forms[0].Target_Index.value == 255 && isTargetChanged)
	{
		document.forms[0].Target_Changed.value = 0;
	}
	else
	{
		document.forms[0].Target_Changed.value = 1;
	}
	if (document.forms[0].Schedule_Index.value == 255 && isScheduleChanged)
	{
		document.forms[0].Schedule_Changed.value = 0;
	}
	else
	{
		document.forms[0].Schedule_Changed.value = 1;
	}
	if(!(confirm(js_pl_change_name
		="If you modify the host,target or schedule which is used by other rules,those rules will be changed too.Are you sure to save the change?")))
	{
		return false;
	}
	return true;
}
function pageload()
{
	doSwitchProto();
	check_all_status();

	LoadHelp("AccessCtrlAccessRuleModifyHelpRpm.htm");
	window.helpLoaded = true;
}
//-->
</SCRIPT>
<style type="text/css">
	div.dayStyle ul.checkbox-group-list-wrap{
		margin-right: 0px;
	}
	div.dayStyle .widget-wrap{
		margin-right: 0px;
	}
	div.dayStyle div.widget-wrap label.checkbox-label span.text{
		padding-left: 4px;
	}
</style>
</HEAD>
<BODY>
<CENTER>
<FORM action="AccessCtrlAccessRulesRpm.htm" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
	<TABLE id="autoWidth">
	<TBODY>
		<TR>
			<TD class="h1" id="t_title">Modify Internet Access Control Entry</TD>
		</TR>
		<TR>
			<TD class="blue"></TD>
		</TR>
		<TR>
			<TD><TABLE>
				<TR>
					<TD class="item" id="t_rule_name">Rule Name: </TD>
					<TD><INPUT name="rule_name" type="text" class="text" value="" size="25" maxlength="24"></TD>
				</TR>
				<TR>
					<TD colspan="2">&nbsp;</TD>
				</TR>
				<TR>
					<TD class="item" id="t_hosts_lists_name">Host Description: </TD>
					<TD><INPUT name="hosts_lists_name" type="text" class="text" value="" size="25" maxlength="24"></TD>
				</TR>
				<TR>
					<TD class="item" id="t_address_type">Address Type: </TD>
					<TD>
						<SELECT size="1" name="address_type" id="address_type" class="list" onChange="selAddrType()">
							<OPTION value="0" id="t_mac_addr">MAC Address</OPTION>
							<OPTION value="1" selected id="t_ip_addr">IP Address</OPTION>
						</SELECT>
					</TD>
				</TR>
				<TR id="ip_area" style="display:none">
					<TD class="item" id="t_lan_ip_addr">LAN IP Address:</TD>
					<TD>
						<INPUT type="text" name="src_ip_start" value="" size="15" maxlength="15" class="text">
						&nbsp;-&nbsp;
						<INPUT type="text" name="src_ip_end" value="" size="15" maxlength="15" class="text">
					</TD>
				</TR>
				<TR id="mac_area" style="display:none">
					<TD class="item" id="t_mac_addr">MAC Address:</TD>
					<TD><INPUT name="mac_addr" type="text" class="text" value="" size="17" maxlength="17"></TD>
				</TR>
				<TR>
					<TD colspan="2">&nbsp;</TD>
				</TR>
				<TR>
					<TD class="item" id="t_targets_lists_name">Target Description: </TD>
					<TD><INPUT name="targets_lists_name" type="text" class="text" value="" size="25" maxlength="24"></TD>
				</TR>
				<TR>
					<TD class="item" id="t_target_type">Target Type: </TD>
					<TD>
						<SELECT size="1" name="target_type" id="target_type" onChange="selTargetType()">
							<OPTION value="0" id="t_mod_domain_name">Domain Name</OPTION>
							<OPTION value="1" id="t_mod_ip_addr">IP Address</OPTION>
						</SELECT>
					</TD>
				</TR>
				<!--IP display-->
				<TR id="ip_dst" style="display:none">
					<TD class="item" id="t_ip_addr">IP Address:</TD>
					<TD>
						<INPUT type="text" name="dst_ip_start" value="" size="15" maxlength="15" class="text">
						&nbsp;-&nbsp;
						<INPUT type="text" name="dst_ip_end" value="" size="15" maxlength="15" class="text">
					</TD>
				</TR>
				<TR id="port" style="display:none">
					<TD class="item" id="t_target_port">Target Port: </TD>
					<TD>
						<INPUT type="text" name="dst_port_start" value="" size="5" maxlength="5" class="text">
						-
						<INPUT type="text" name="dst_port_end" value="" size="5" maxlength="5" class="text">
					</TD>
				</TR>
				<TR id="proto_area" style="display:none">
					<TD class="item" id="t_protocal">Protocol:</TD>
					<TD>
						<SELECT size="1" name="proto" id="proto" onChange="doSwitchProto()">
							<OPTION value="0" id="t_all">All</OPTION>
							<OPTION value="1" id="t_tcp">TCP</OPTION>
							<OPTION value="2" id="t_udp">UDP</OPTION>
							<OPTION value="3" id="t_icmp">ICMP</OPTION>
						</SELECT>
					</TD>
				</TR>
				<TR id="commonportlist" style="display:none">
					<TD class="item" id="t_com_ser_port">Common Service Port:</TD>
					<TD><SELECT name="Commonport" id="Commonport" onChange="doCommonPortChange()">
						<SCRIPT type="text/javascript">
						for (i=0;i<11;i++)
						{
							document.write('<option value='+i+ commonportlist[(i*4)+2] +'/option>');
						}
						</SCRIPT>
					</SELECT></TD>
				</TR>
				<!--URLS***-->
				<TR id="url0" style="display:none">
					<TD class="Item" id="t_domain_name">Domain Name:</TD>
					<TD><INPUT name="url_0" type="text" class="text" value="" size="32" maxlength="30"></TD>
				</TR>
				<TR id="url1" style="display:none">
					<TD>&nbsp;</TD>
					<TD><INPUT name="url_1" type="text" class="text" value="" size="32" maxlength="30"></TD>
				</TR>
				<TR id="url2" style="display:none">
					<TD>&nbsp;</TD>
					<TD><INPUT name="url_2" type="text" class="text" value="" size="32" maxlength="30"></TD>
				</TR>
				<TR id="url3" style="display:none">
					<TD>&nbsp;</TD>
					<TD><INPUT name="url_3" type="text" class="text" value="" size="32" maxlength="30"></TD>
				</TR>
				<TR>
					<TD colspan="2">&nbsp;</TD>
				</TR>
				<TR>
					<TD class="item" id="t_sch">Schedule Description:</TD>
					<TD><INPUT name="time_sched_name" type="text" class="text" value="" size="25" maxlength="24"></TD>
				</TR>
				<TR>
					<TD class="item" id="t_day">Day:</TD>
					<TD><input id="day_type" name="day_type" /></TD>
				</TR>
				<TR>
					<TD>&nbsp;</TD>
					<TD>
						<input id="Mon_select" name="Mon_select" />
						<input id="Tue_select" name="Tue_select" />
						<input id="Wed_select" name="Wed_select" />
						<input id="Thu_select" name="Thu_select" />
						<input id="Fri_select" name="Fri_select" />
						<input id="Sat_select" name="Sat_select" />
						<input id="Sun_select" name="Sun_select" />
					</TD>
				</TR>
				<TR>
					<TD class="item" id="t_time">Time: </TD>
					<TD><input id="all_hours" name="all_hours" /></TD>
				</TR>
				<TR>
					<TD class="item" id="t_start_time">Start Time:</TD>
					<TD>
						<INPUT name="time_sched_start_time" type="text" class="text" value="" size="5" maxlength="4">
						&nbsp;(HHMM)
					</TD>
				</TR>
				<TR>
					<TD class="item" id="t_stop_time">Stop Time:</TD>
					<TD>
						<INPUT name="time_sched_end_time" type="text" class="text" value="" size="5" maxlength="4">
						&nbsp;(HHMM)
					</TD>
				</TR>
				<TR>
					<TD colspan="2">&nbsp;</TD>
				</TR>
				<TR>
					<TD class="item" id="t_status">Status:</TD>
					<TD>
						<SELECT size="1" name="enable" id="enable" class="listS">
							<OPTION value="0" id="t_disble">Disabled</OPTION>
							<OPTION value="1" id="t_enable">Enabled</OPTION>
						</SELECT>
					</TD>
				</TR>
			</TABLE></TD>
		</TR>
		<TR>
			<TD class="blue"></TD>
		</TR>
		<TR>
			<TD class="mbtn">
				<INPUT name="Changed" type="hidden" value="">
				<INPUT name="SelIndex" type="hidden" value="">
				<INPUT name="Page" type="hidden" value="">
				<INPUT name="Host_Changed" type="hidden" value="">
				<INPUT name="Host_Index" type="hidden" value="">
				<INPUT name="Target_Changed" type="hidden" value="">
				<INPUT name="Target_Index" type="hidden" value="">
				<INPUT name="Schedule_Changed" type="hidden" value="">
				<INPUT name="Schedule_Index" type="hidden" value="">
				&nbsp;
				<INPUT name="Save" type="submit" class="buttonBig" value="Save">           
				&nbsp;
				 <INPUT type="button" value="Back" name="Back" class="buttonBig" onClick="doBack(access_rules_adv_dyn_array[7]);">
			</TD>
		</TR>
	</TBODY>
	</TABLE>
</FORM>
</CENTER>
<script type="text/javascript">
	<!--Hosts***-->
	document.forms[0].address_type.value = hosts_lists_adv_dyn_array[0];
	$("select#address_type").combobox({});
	<!--Targets***-->
	document.forms[0].target_type.value = access_targetss_adv_dyn_array[0];
	$("select#target_type").combobox({});
	
	if (access_targetss_adv_dyn_array[0] == 1)
	{
		document.forms[0].proto.value = access_targetss_adv_dyn_array[4];
	}
	else
	{
		document.forms[0].proto.value = 0;
	}
	$("select#proto").combobox({inputCls: "s"});
	$("select#Commonport").combobox({}).combobox("selWithoutTrigger", 0);
	<!--Schedule***-->
	$("input#day_type").radio({
		columns: 2,
		items: [
			{boxlabel: (js_everyday = "Everyday"), inputvalue: "1", id: "day_type_all"},
			{boxlabel: (js_sel_day = "Select Days"), inputvalue: "0", id: "day_type_choose"}
		]
	}).on("ev_click", change_weekdays_status);
	$("input#Mon_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_mon = "Mon"), inputvalue: 1}]
	});
	$("input#Tue_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_tue = "Tue"), inputvalue: 1}]
	});
	$("input#Wed_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_wen = "Wed"), inputvalue: 1}]
	});
	$("input#Thu_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_thu = "Thu"), inputvalue: 1}]
	});
	$("input#Fri_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_fri = "Fri"), inputvalue: 1}]
	});
	$("input#Sat_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_sat = "Sat"), inputvalue: 1}]
	});
	$("input#Sun_select").checkbox({
		cls: "inline dayStyle",
		items: [{boxlabel: (js_sun = "Sun"), inputvalue: 1}]
	});
	$("input#all_hours").checkbox({
		items: [{boxlabel: (js_all = "all day-24 hours"), inputvalue: 1}]
	}).on("ev_change", change_hours_status);
	
	document.forms[0].enable.value = access_rules_adv_dyn_array[4];
	$("select#enable").combobox({inputCls: "m"});
</script>
<SCRIPT type="text/javascript">
<!--Rule***-->
	document.forms[0].rule_name.value = access_rules_adv_dyn_array[0];
<!--Hosts***-->
	document.forms[0].hosts_lists_name.value = hosts_lists_adv_dyn_array[1];
	str=style_display_on();
	document.getElementById("ip_area").style.display=(hosts_lists_adv_dyn_array[0])?str:"none";
	document.getElementById("mac_area").style.display=(hosts_lists_adv_dyn_array[0])?"none":str;
	if (hosts_lists_adv_dyn_array[0] == 1)
	{
		if (hosts_lists_adv_dyn_array[2] == hosts_lists_adv_dyn_array[3])
		{document.forms[0].src_ip_start.value = hosts_lists_adv_dyn_array[2];
		document.forms[0].src_ip_end.value = "";}
		else{
		document.forms[0].src_ip_start.value = hosts_lists_adv_dyn_array[2];
		document.forms[0].src_ip_end.value = hosts_lists_adv_dyn_array[3];}
	}
	else
	{
		document.forms[0].mac_addr.value = hosts_lists_adv_dyn_array[4];
	}
	document.forms[0].Host_Changed.value = hosts_lists_adv_dyn_array[5];
	document.forms[0].Host_Index.value = hosts_lists_adv_dyn_array[6];
	//document.forms[0].Page.value = hosts_lists_adv_dyn_array[7];
	
<!--Targets***-->
	if (access_targetss_adv_dyn_array[1] == "NA")
	{
		access_targetss_adv_dyn_array[1] = "";
	}
	
	document.forms[0].targets_lists_name.value = access_targetss_adv_dyn_array[1];
	str=style_display_on();
	document.getElementById("ip_dst").style.display=(access_targetss_adv_dyn_array[0])?str:"none";
	document.getElementById("port").style.display=(access_targetss_adv_dyn_array[0])?str:"none";
	document.getElementById("proto_area").style.display=(access_targetss_adv_dyn_array[0])?str:"none";
	document.getElementById("commonportlist").style.display=(access_targetss_adv_dyn_array[0])?str:"none";
	document.getElementById("url0").style.display=(access_targetss_adv_dyn_array[0])?"none":str;
	document.getElementById("url1").style.display=(access_targetss_adv_dyn_array[0])?"none":str;
	document.getElementById("url2").style.display=(access_targetss_adv_dyn_array[0])?"none":str;
	document.getElementById("url3").style.display=(access_targetss_adv_dyn_array[0])?"none":str;
	if (access_targetss_adv_dyn_array[0] == 1)
	{
		document.forms[0].dst_ip_start.value = access_targetss_adv_dyn_array[2];
		if (access_targetss_adv_dyn_array[2] != access_targetss_adv_dyn_array[3])
		document.forms[0].dst_ip_end.value = access_targetss_adv_dyn_array[3];
		document.forms[0].dst_port_start.value = access_targetss_adv_dyn_array[5];
		if (access_targetss_adv_dyn_array[5] != access_targetss_adv_dyn_array[6])
		document.forms[0].dst_port_end.value = access_targetss_adv_dyn_array[6];
	}
	else
	{
		document.forms[0].url_0.value = access_targetss_adv_dyn_array[7];
		document.forms[0].url_1.value = access_targetss_adv_dyn_array[8];
		document.forms[0].url_2.value = access_targetss_adv_dyn_array[9];
		document.forms[0].url_3.value = access_targetss_adv_dyn_array[10];
	}
	document.forms[0].Target_Changed.value = access_targetss_adv_dyn_array[11];
	document.forms[0].Target_Index.value = access_targetss_adv_dyn_array[12];
	
	<!--Schedule***-->
	if (timeSchedAdvDynArray[0] == "NA")
	{
		timeSchedAdvDynArray[0]= "";
	}

	document.forms[0].time_sched_name.value =timeSchedAdvDynArray[0];
	if (document.forms[0].time_sched_name.value == "")
	{
		timeSchedAdvDynArray[1] = 1;
		timeSchedAdvDynArray[9] = 1;
	}
	if(1 == timeSchedAdvDynArray[1])
	{
		$("input#day_type").radio("setValue", 1);
	}
	if (0 == timeSchedAdvDynArray[1])
	{
		$("input#day_type").radio("setValue", 0);
	}
	change_weekdays_status();
	$("input#all_hours").checkbox("setChecked", timeSchedAdvDynArray[9]);
	change_hours_status();
	document.forms[0].time_sched_start_time.value =timeSchedAdvDynArray[10];
	document.forms[0].time_sched_end_time.value =timeSchedAdvDynArray[11];
	document.forms[0].Schedule_Changed.value = timeSchedAdvDynArray[12];
	document.forms[0].Schedule_Index.value = timeSchedAdvDynArray[13];
	
	document.forms[0].Changed.value = access_rules_adv_dyn_array[5];
	document.forms[0].SelIndex.value = access_rules_adv_dyn_array[6];
</SCRIPT>
</BODY>
<HEAD>
<META http-equiv="pragma" content="no-cache">
</HEAD>
</HTML>